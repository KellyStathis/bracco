<div class="container-fluid">
  <div class="content">
    {{#if (can "list user")}}
      <div class="row">
        <div class='col-md-9'>
          <div class="search-wide">
            <form {{action "doSearch" query on="submit"}} class="form-horizontal">
              <div class="input-group">
                {{input name="query" value=query class="form-control" placeholder="Search for user"}}

                <div class="input-group-btn">
                  <button type="submit" class="btn btn-primary hidden-xs">Search</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="row">
        <div class='col-md-9 panel-list' id="content">
          {{#if model}}
            {{#each model as |user|}}
              <div class="panel panel-default">
                <div class="panel-heading">
                  <a class="accordion-toggle" id="link_{{user.orcid}}" data-toggle="collapse" data-parent="#user" href="#user_{{user.orcid}}">
                    {{user.creditName}}{{#if user.role}}<span class='small pull-right'>{{user.role}}</span>{{/if}}
                  </a>
                </div>
                <div id="user_{{user.orcid}}" class="panel-collapse collapse">
                  <div class="panel-body user-list">
                    {{#if user.email}}
                      <h5>Email</h5>
                      <a href="mailto:{{user.email}}">{{user.email}}</a>
                    {{/if}}

                    <h5>ORCID</h5>
                    <a href="{{user.id}}">{{user.orcid}}</a>

                    {{#if user.member}}
                      <h5>Member</h5>
                      {{#link-to "members.show" user.member.id}}{{user.member.title}}{{/link-to}}
                    {{/if}}

                    {{#if user.role}}
                      <h5>Role</h5>
                      {{user.role}}
                    {{/if}}

                    <h5>Account created</h5>
                    {{format-date user.created}}
                  </div>
                </div>
              </div>
            {{/each}}
            <div class="text-center">
              {{#if (gt model.meta.total_pages 1)}}
                {{page-numbers content=content}}
              {{/if}}
            </div>
          {{else}}
            <div class="alert alert-simple-info">
              <h5>There are currently no users
              </h5>
            </div>
          {{/if}}
        </div>
        <div class='col-md-3'>
          {{#if model.meta.roles}}
            <div class="panel facets">
              <div class="panel-body">
                <h4>Roles</h4>
                <ul>
                  {{#each model.meta.roles as |role|}}
                    <li>
                      {{#if model.otherParams.role}}
                        {{#link-to "users" (query-params role='')}}{{fa-icon "check-square-o"}}{{/link-to}}
                      {{else}}
                        {{#link-to "users" (query-params role=role.id)}}{{fa-icon "square-o"}}{{/link-to}}
                      {{/if}}
                      <div class="facet-title">{{role.title}}</div>
                      <span class="number pull-right">{{role.count}}</span>
                      <div class="clearfix"/>
                    </li>
                  {{/each}}
                </ul>
              </div>
            </div>
          {{/if}}
        </div>
      </div>
    {{/if}}
  </div>
</div>
