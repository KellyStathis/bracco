{{#if (can 'read index')}}
  <ApplicationHeader @default={{true}} />
  <div class="container-fluid">
    <IndexHeader />
    <div class="col-md-3">
      {{#if model.meta.roles}}
        <div class="panel facets add">
          <div class="panel-body">
            <h4>
              Role
              <span class="small">
                <i class="fas fa-question-circle"></i>
                <BsTooltip @placement="top">
                  Filter contacts by their role.
                </BsTooltip>
              </span>
            </h4>
            <ul>
              {{#each model.meta.roles as |role|}}
                <li>
                  {{#if model.query.role}}
                    <LinkTo @route="contacts" @query={{hash role=null}}>
                      <i class="far fa-check-square"></i>
                    </LinkTo>
                  {{else}}
                    <LinkTo @route="contacts" @query={{hash role=role.id}}>
                      <i class="far fa-square"></i>
                    </LinkTo>
                  {{/if}}
                  <div class="facet-title">
                    {{role.title}}
                  </div>
                  <span class="number pull-right">
                    {{role.count}}
                  </span>
                  <div class="clearfix"></div>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
      {{#if model.meta.providers}}
        <div class="panel facets">
          <div class="panel-body">
            <h4>
              Member
            </h4>
            <ul>
              {{#each model.meta.providers as |provider|}}
                <li>
                  {{#if model.query.provider-id}}
                    <LinkTo @route="prefixes" @query={{hash provider-id=null}}>
                      <i class="far fa-check-square"></i>
                    </LinkTo>
                  {{else}}
                    <LinkTo
                      @route="prefixes"
                      @query={{hash provider-id=provider.id}}
                    >
                      <i class="far fa-square"></i>
                    </LinkTo>
                  {{/if}}
                  <div class="facet-title">
                    {{provider.title}}
                  </div>
                  <span class="number pull-right">
                    {{provider.count}}
                  </span>
                  <div class="clearfix"></div>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
    </div>
    <div class="col-md-9 panel-list" id="content">
      <ModelSearch
        @model={{model}}
        @name="Contact"
        @sortable={{true}}
        @link="contacts"
      />
      {{#if model}}
        {{#each model as |contact|}}
          <div class="panel panel-transparent" data-test-prefix>
            <div class="panel-body">
              <h3 class="member">
                {{contact.id}}
              </h3>
              <h5>
                {{contact.provider.name 'Member'}}
              </h5>
              <h5>
                Created
              </h5>
              {{format-time
                contact.createdAt
                year='numeric'
                month='long'
                day='numeric'
                hour='numeric'
                minute='numeric'
                second='numeric'
                timeZone='UTC'
                timeZoneName='short'
                hour12=false
              }}
            </div>
          </div>
        {{/each}}
        <div class="text-center">
          {{#if (gt model.meta.totalPages 1)}}
            <PageNumbers @model={{model}} @link="contacts" />
          {{/if}}
        </div>
      {{else}}
        <BsAlert @dismissible={{false}} @type="warning">
          No contacts found.
        </BsAlert>
      {{/if}}
    </div>
  </div>
{{else}}
  <ApplicationHeader /><LandingPage />
{{/if}}