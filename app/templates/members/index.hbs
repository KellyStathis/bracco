{{#if (can "read member")}}
  <div class="row">
    <div class='col-md-9'>
      <div class="search-wide">
        <form action="/members" method="GET" class="form-horizontal">
          <div class="input-group">
            {{input type="hidden" valueBinding="memberType"}}
            {{input type="hidden" valueBinding="region"}}
            {{input type="hidden" valueBinding="year"}}
            {{input name="query" valueBinding="query" class="form-control" placeholder="Search for member"}}

            <div class="input-group-btn">
              <button type="submit" class="btn btn-primary hidden-xs">Search</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class='col-md-3'>
    </div>
  </div>

  <div class="row">
    <div class='col-md-9 panel-list' id="content">
      {{#unless (can "write member")}}
      <div class="panel panel-default">
        </div>
      {{else}}
        {{#if model}}
          {{#each model as |member|}}
            <div class="panel panel-default">
              <div class="panel-body">
                <h3>
                  <span class="label label-default label-{{member.memberType}} pull-right">{{member.memberType}} member</span>
                  {{#link-to "members.show" member.id}}{{member.title}}{{/link-to}}
                </h3>
                <div class="country">{{member.country}}</div>
              </div>
              <div class="panel-footer">
                {{member.name}}
              </div>
            </div>
          {{/each}}
          <div class="text-center">
            {{page-numbers content=content currentPage=page showFL=true}}
          </div>
        {{else}}
          <div class="alert alert-simple-info">
            <h5>There are currently no members
            </h5>
          </div>
        {{/if}}
      {{/unless}}
    </div>
    <div class='col-md-3'>
      {{#if model.meta.member-types}}
        <div class="panel facets">
          <div class="panel-body">
            <h4>Member types</h4>
            <ul>
              {{#each model.meta.member-types as |memberType|}}
                <li>
                  {{#if model.otherParams.member-type}}
                    {{#link-to "members" (query-params member-type='')}}{{fa-icon "check-square-o"}}{{/link-to}}
                  {{else}}
                    {{#link-to "members" (query-params member-type=memberType.id)}}{{fa-icon "square-o"}}{{/link-to}}
                  {{/if}}
                  <div class="facet-title">{{memberType.title}}</div>
                  <span class="number pull-right">{{memberType.count}}</span>
                  <div class="clearfix"/>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
      {{#if model.meta.regions}}
        <div class="panel facets">
          <div class="panel-body">
            <h4>Regions</h4>
            <ul>
              {{#each model.meta.regions as |region|}}
                <li>
                  {{#if model.otherParams.region}}
                    {{#link-to "members" (query-params region='')}}{{fa-icon "check-square-o"}}{{/link-to}}
                  {{else}}
                    {{#link-to "members" (query-params region=region.id)}}{{fa-icon "square-o"}}{{/link-to}}
                  {{/if}}
                  <div class="facet-title">{{region.title}}</div>
                  <span class="number pull-right">{{region.count}}</span>
                  <div class="clearfix"/>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
      {{#if model.meta.years}}
        <div class="panel facets">
          <div class="panel-body">
            <h4>Years</h4>
            <ul>
              {{#each model.meta.years as |year|}}
                <li>
                  {{#if model.otherParams.year}}
                    {{#link-to "members" (query-params year='')}}{{fa-icon "check-square-o"}}{{/link-to}}
                  {{else}}
                    {{#link-to "members" (query-params year=year.id)}}{{fa-icon "square-o"}}{{/link-to}}
                  {{/if}}
                  <div class="facet-title">{{year.title}}</div>
                  <span class="number pull-right">{{year.count}}</span>
                  <div class="clearfix"/>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      {{/if}}
    </div>
  </div>
{{/if}}
